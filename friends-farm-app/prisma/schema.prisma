generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model cache {
  key        String @id @db.VarChar(255)
  value      String
  expiration Int
}

model cache_locks {
  key        String @id @db.VarChar(255)
  owner      String @db.VarChar(255)
  expiration Int
}

model categories {
  id         String     @id @db.Uuid
  name       String     @db.VarChar(255)
  name_ar    String     @db.VarChar(255)
  image_url  String?    @db.VarChar(255)
  created_at          DateTime?  @db.Timestamp(0)
  updated_at          DateTime?  @db.Timestamp(0)
  discount_percentage Int        @default(0)
  is_offer_active     Boolean    @default(false)
  products            products[]
}

model failed_jobs {
  id         BigInt   @id @default(autoincrement())
  uuid       String   @unique(map: "failed_jobs_uuid_unique") @db.VarChar(255)
  connection String
  queue      String
  payload    String
  exception  String
  failed_at  DateTime @default(now()) @db.Timestamp(0)
}

model job_batches {
  id             String  @id @db.VarChar(255)
  name           String  @db.VarChar(255)
  total_jobs     Int
  pending_jobs   Int
  failed_jobs    Int
  failed_job_ids String
  options        String?
  cancelled_at   Int?
  created_at     Int
  finished_at    Int?
}

model jobs {
  id           BigInt @id @default(autoincrement())
  queue        String @db.VarChar(255)
  payload      String
  attempts     Int    @db.SmallInt
  reserved_at  Int?
  available_at Int
  created_at   Int

  @@index([queue], map: "jobs_queue_index")
}

model migrations {
  id        Int    @id @default(autoincrement())
  migration String @db.VarChar(255)
  batch     Int
}

model offers {
  id                  BigInt    @id @default(autoincrement())
  title               String    @db.VarChar(255)
  description         String?
  image               String?   @db.VarChar(255)
  discount_percentage Int?
  is_active           Boolean   @default(true)
  created_at          DateTime? @db.Timestamp(0)
  updated_at          DateTime? @db.Timestamp(0)
  offer_price         Decimal?  @db.Decimal(10, 2)
  original_price      Decimal?  @db.Decimal(10, 2)
}

model order_items {
  id         String    @id @db.Uuid
  order_id   String    @db.Uuid
  product_id String?   @db.Uuid
  quantity   Decimal   @db.Decimal(10, 2)
  price      Decimal   @db.Decimal(10, 2)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  orders     orders    @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "order_items_order_id_foreign")
  products   products? @relation(fields: [product_id], references: [id], onUpdate: NoAction, map: "order_items_product_id_foreign")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model orders {
  id             String        @id @db.Uuid
  user_id        String?       @db.Uuid
  total          Decimal       @db.Decimal(10, 2)
  status         String        @default("pending") @db.VarChar(255)
  payment_method String        @default("cod") @db.VarChar(255)
  address        String
  notes          String?
  created_at     DateTime?     @db.Timestamp(0)
  updated_at     DateTime?     @db.Timestamp(0)
  order_items    order_items[]
  users          User?         @relation(fields: [user_id], references: [id], onUpdate: NoAction, map: "orders_user_id_foreign")
}

model password_reset_tokens {
  email      String    @id @db.VarChar(255)
  token      String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
}

model products {
  id             String        @id @db.Uuid
  category_id    String?       @db.Uuid
  name           String        @db.VarChar(255)
  name_ar        String        @db.VarChar(255)
  description    String?
  description_ar String?
  price          Decimal       @db.Decimal(10, 2)
  unit           String        @default("kg") @db.VarChar(255)
  image_url      String?       @db.VarChar(255)
  stock          Int           @default(0)
  is_available   Boolean       @default(true)
  is_featured    Boolean       @default(false)
  created_at     DateTime?     @db.Timestamp(0)
  updated_at     DateTime?     @db.Timestamp(0)
  order_items    order_items[]
  categories     categories?   @relation(fields: [category_id], references: [id], onUpdate: NoAction, map: "products_category_id_foreign")
  reviews        reviews[]
  wishlists      wishlists[]
}

model reviews {
  id             BigInt    @id @default(autoincrement())
  product_id     String    @db.Uuid
  user_id        String?   @db.Uuid
  customer_name  String    @db.VarChar(255)
  customer_email String?   @db.VarChar(255)
  rating         Int       @default(5)
  comment        String
  is_approved    Boolean   @default(true)
  is_admin_added Boolean   @default(false)
  created_at     DateTime? @db.Timestamp(0)
  updated_at     DateTime? @db.Timestamp(0)
  products       products  @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "reviews_product_id_foreign")
  users          User?     @relation(fields: [user_id], references: [id], onUpdate: NoAction, map: "reviews_user_id_foreign")
}

model sessions {
  id            String  @id @db.VarChar(255)
  user_id       BigInt?
  ip_address    String? @db.VarChar(45)
  user_agent    String?
  payload       String
  last_activity Int

  @@index([last_activity], map: "sessions_last_activity_index")
  @@index([user_id], map: "sessions_user_id_index")
}

model settings {
  id         BigInt    @id @default(autoincrement())
  key        String    @unique(map: "settings_key_unique") @db.VarChar(255)
  value      String?
  label      String?   @db.VarChar(255)
  group      String    @default("general") @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
}

model User {
  id                String      @id @db.Uuid
  name              String?     @db.VarChar(255)
  email             String?     @unique(map: "users_email_unique") @db.VarChar(255)
  phone             String?     @unique(map: "users_phone_unique") @db.VarChar(255)
  address           String?     @db.VarChar(255)
  google_id         String?     @unique(map: "users_google_id_unique") @db.VarChar(255)
  email_verified_at DateTime?   @db.Timestamp(0)
  password          String?     @db.VarChar(255)
  is_admin          Boolean     @default(false)
  remember_token    String?     @db.VarChar(100)
  created_at        DateTime?   @db.Timestamp(0)
  updated_at        DateTime?   @db.Timestamp(0)
  image             String?
  display_id        Int         @unique @default(autoincrement())
  accounts          Account[]
  sessions          Session[]
  orders            orders[]
  reviews           reviews[]
  wishlists         wishlists[]

  @@map("users")
}

model Account {
  id                String  @id @default(cuid())
  userId            String  @map("user_id") @db.Uuid
  type              String
  provider          String
  providerAccountId String  @map("provider_account_id")
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  user              User    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique @map("session_token")
  userId       String   @map("user_id") @db.Uuid
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("next_auth_sessions")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}

model wishlists {
  id         BigInt    @id @default(autoincrement())
  user_id    String    @db.Uuid
  product_id String    @db.Uuid
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)
  products   products  @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "wishlists_product_id_foreign")
  users      User      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "wishlists_user_id_foreign")

  @@unique([user_id, product_id], map: "wishlists_user_id_product_id_unique")
}
